WEBVTT
Kind: captions
Language: zh-CN

00:00:00.000 --> 00:00:03.350
现在你对 Window（窗口）函数的工作原理更熟悉了

00:00:03.350 --> 00:00:05.359
我们现在开始深入了解其真正的力量

00:00:05.360 --> 00:00:07.107
使用 Windows（窗口）函数时

00:00:07.107 --> 00:00:11.539
你可以使用与正常情况下的相同的聚合：求和、

00:00:11.539 --> 00:00:14.719
计数、平均值、最小值以及最大值

00:00:14.720 --> 00:00:18.650
理解这些聚合函数工作机制的最简单的办法是一次性运行这些函数

00:00:18.649 --> 00:00:21.969
我们只需要把这些函数应用到早先的例子中

00:00:21.969 --> 00:00:24.799
让我们一次性来看看这些中的每一个函数

00:00:24.800 --> 00:00:26.810
首先 我们来看看 SUM（求和）

00:00:26.809 --> 00:00:29.209
该函数会创建一个运行加总的命令

00:00:29.210 --> 00:00:35.000
第一行就是标准数值 123 

00:00:35.000 --> 00:00:37.655
第二行与第三行数值相同

00:00:37.655 --> 00:00:40.939
因为这些行是根据发生日期的月份排序的

00:00:40.939 --> 00:00:45.214
第二行与第三行月份相同 因此它们被分到同一组

00:00:45.215 --> 00:00:48.850
类似于在使用 RANK 和 DENSE RANK 时的分组方式

00:00:48.850 --> 00:00:53.780
因此 值 819 等于第一行 123 

00:00:53.780 --> 00:00:59.340
加上第二行与第三行的 506 和 190 

00:00:59.340 --> 00:01:03.930
第四行与第五行由于月份相同 也被分到同一组

00:01:03.929 --> 00:01:08.165
COUNT 用来计数并采用同样的分组机制

00:01:08.165 --> 00:01:11.635
可以看到第二行与第三行的计数都是 3

00:01:11.635 --> 00:01:15.230
第四行与第五行的计数都是 5

00:01:15.230 --> 00:01:17.650
AVERAGE 显示的是运行平均值

00:01:17.650 --> 00:01:20.050
该数值就是总和除以

00:01:20.049 --> 00:01:26.314
计数 即 819 除以 3 等于 273 

00:01:26.314 --> 00:01:30.634
1430 除以 5 等于 286

00:01:30.635 --> 00:01:34.740
MIN 显示的是窗口中到该点为止的最小值

00:01:34.739 --> 00:01:39.164
123 是直到 85 出现之前的最小值

00:01:39.165 --> 00:01:41.615
它是整个窗口中的最小值

00:01:41.614 --> 00:01:46.834
因此 直到下一窗口以 1,011 计数开始前 将一直保持在 85

00:01:46.834 --> 00:01:49.819
最大值与最小值的原理相同

00:01:49.819 --> 00:01:54.159
它始终显示当前窗口中给定行的最大值

