WEBVTT
Kind: captions
Language: ar

00:00:00.000 --> 00:00:04.833
أسهل طريقة للبدء في استخدام دوال النافذة
هي استخدام الدوال التي تعدّ فحسب.

00:00:04.933 --> 00:00:06.867
فهي لا تقوم بالتجميع في الواقع.

00:00:06.967 --> 00:00:10.133
تقوم ROW_NUMBER بالضبط
بما يوحي به اسمها.

00:00:10.233 --> 00:00:14.300
فهي تعرض رقم صف محدد
ضمن النافذة التي حددتَها.

00:00:14.400 --> 00:00:16.300
تبدأ العد من 1 وترقّم الصفوف

00:00:16.400 --> 00:00:19.900
وفقاً لجزئية ORDER BY
في عبارة إنشاء النافذة.

00:00:20.000 --> 00:00:25.833
لا تتطلب ROW_NUMBER
منك تحديد متغيّر داخل القوسين.

00:00:25.933 --> 00:00:32.567
هنا، نحن نرتّب حسب الحقل id
الذي يزيد بمقدار 1 في كل صف.

00:00:32.667 --> 00:00:38.267
أي أن الحقلين id و row_num
لديهما نفس القيمة دائماً.

00:00:38.367 --> 00:00:40.233
لكن إذا رتبنا حسب occurred_at،

00:00:40.333 --> 00:00:42.000
فستترتب الصفوف بشكل مختلف،

00:00:42.100 --> 00:00:46.133
وبالتالي سيتم تعيين قيم العمود
row_num بشكل مختلف.

00:00:46.233 --> 00:00:49.533
كما ترى فإن رقم الصف
لم يعد يطابق رقم المعرّف ID.

00:00:49.633 --> 00:00:51.667
باستخدام بند PARTITION BY،

00:00:51.767 --> 00:00:55.867
يمكننا إعادة العد من جديد
بدءاً بالرقم 1 في كل قسم.

00:00:55.967 --> 00:01:00.567
لنقسّم حسب معرف الحساب account_id
لنرى كيف يبدو ذلك.

00:01:01.400 --> 00:01:05.833
هذا يعرض لنا رقم كل صف من الصفوف
التي يجمعها معرّف حساب account_id واحد،

00:01:05.933 --> 00:01:09.600
ويكون الصف 1 هو أول طلبية شراء.

00:01:09.700 --> 00:01:11.767
هناك دالة أخرى وهي RANK،

00:01:11.867 --> 00:01:16.733
وهي تؤدي غرضاً مشابهاً. لنلق نظرة.

00:01:18.567 --> 00:01:21.867
رغم أن هذا قد يبدو مشابهاً لما سبقه،

00:01:21.967 --> 00:01:23.667
إلا أن هناك فرقاً طفيفاً.

00:01:23.767 --> 00:01:27.833
إذا كان لسطرين متواليين
نفس القيمة في العمود occurred_at،

00:01:27.933 --> 00:01:29.333
فإنهما يُمنحان الرتبة نفسها،

00:01:29.433 --> 00:01:33.167
بينما تعيّن لهما دالة ROW NUMBER
رقمين مختلفين.

00:01:33.267 --> 00:01:38.733
ستلاحظ ذلك أكثر إذا ما استخدمنا DATE_TRUNC
على العمود occured_at لاقتطاع الشهر.

00:01:59.433 --> 00:02:05.333
كما ترى، فإن مدخلات الشهر نفسه
قد أسنِدت إليها الرتبة نفسها،

00:02:05.433 --> 00:02:08.600
ويتخطى عمود الرتبة
بعض القيم للتعويض عن ذلك.

00:02:08.700 --> 00:02:11.233
هناك دالة مشابهة،

00:02:11.333 --> 00:02:16.467
وهي DENSE_RANK، وهي لا تتخطى
القيم بعد إسناد الرتبة نفسها لعدة صفوف.

00:02:16.567 --> 00:02:19.933
أترى كيف ينتقل هذا الصف
من الرتبة 2 إلى الرتبة 4.
32
00:02:20,033 --&gt; 00:00:00,000
لكن مع DENSE_RANK
تنتقل من 2 إلى 3 مباشرة.

