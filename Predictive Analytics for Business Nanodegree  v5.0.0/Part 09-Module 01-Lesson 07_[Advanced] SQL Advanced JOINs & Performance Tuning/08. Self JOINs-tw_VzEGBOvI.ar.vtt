WEBVTT
Kind: captions
Language: ar

00:00:00.000 --> 00:00:04.467
من المفيد أحياناً ربط جدول بنفسه.

00:00:04.567 --> 00:00:07.500
في أغلب الأوقات،
ستقوم بذلك لتجد حالات

00:00:07.600 --> 00:00:10.933
يقع فيها حدثان واحداً تلو الآخر.

00:00:11.033 --> 00:00:16.567
مثلاً، تخيّل أنك تريد أن تعرف أي الحسابات
تم فيها شراء عدة طلبات في غضون 30 يوماً.

00:00:16.667 --> 00:00:19.900
إحدى طرق القيام بذلك هي ربط جدول الطلبات

00:00:20.000 --> 00:00:24.400
بنفسه بعملية الربط بعدم المساواة.

00:00:24.500 --> 00:00:29.367
لنشرح سريعاً منطق عملية الربط هذه
لأنه معقد بعض الشيء.

00:00:29.467 --> 00:00:34.433
أولاً، علينا التأكد من أننا
نقوم بالربط على الحساب نفسه.

00:00:34.533 --> 00:00:36.900
لذا، في جدول الطلبات الأول،

00:00:37.000 --> 00:00:39.100
الذي رمزنا له بالرمز o1،

00:00:39.200 --> 00:00:42.567
سنبحث عن معرف الحساب ونقارنه

00:00:42.667 --> 00:00:47.367
بمعرف الحساب
في جدول الطلبات الثاني "o2".

00:00:47.467 --> 00:00:49.867
إنه الجدول نفسه في واقع الأمر،

00:00:49.967 --> 00:00:53.667
ولكننا نربطه بنفسه
ونعطيه اسماً مستعاراً مختلفاً.

00:00:53.767 --> 00:00:56.533
بما أننا نريد أن تكون سجلات o2

00:00:56.633 --> 00:01:00.900
قد حدثت بتاريخ يقع ضمن نطاق 28
يوماً من تاريخ وقوع سجلات o1،

00:01:01.000 --> 00:01:03.167
فسوف نضع عبارتين شرطيتين

00:01:03.267 --> 00:01:06.133
في بند JOIN، وكلاهما بعدم المساواة.

00:01:06.233 --> 00:01:13.467
أولاً، سنقوم بالربط حيث o2.occurred-at
أكبر من o1.occurred-at.

00:01:13.567 --> 00:01:18.533
لذا سنبحث عن الطلبات
التي تمت بعد تقديم الطلب الأصلي.

00:01:18.633 --> 00:01:25.467
ثم، سنبحث عن الطلبات
حيث o2.occurred-at أقل من أو تساوي

00:01:25.567 --> 00:01:33.433
28 يوماً بعد o1.occurred-at،
أي أننا سنحدد السجلات وفقاً لوقت حدوثها.

00:01:33.533 --> 00:01:36.000
الأمر الذي يجب تذكره
عند القيام بعمليات الربط بالذات

00:01:36.100 --> 00:01:40.000
هو أن عليك استخدام أسماء مستعارة
لتمييز الجدول الأيسر عن الأيمن

00:01:40.100 --> 00:01:45.867
لأن الإشارة إلى أحدهما باستخدام الاسم
"orders" ستكون مبهمة في هذه الحالة.

00:01:45.967 --> 00:01:49.467
هنا، مرة أخرى، سنستخدم الاسمين o1 و o2 .

