WEBVTT
Kind: captions
Language: zh-CN

00:00:00.000 --> 00:00:02.910
作为一名 Parch &amp; Posey 的销售运营经理

00:00:02.910 --> 00:00:06.675
将订单进行分组 是一项很有用的练习

00:00:06.674 --> 00:00:11.219
当然 如果你能计算出每一组的所有订单数 那更好

00:00:11.220 --> 00:00:14.475
对这些新分类进行聚合

00:00:14.474 --> 00:00:18.695
能让你更容易地向领导汇报并采取相应行动

00:00:18.695 --> 00:00:20.429
进行组内计数的最简单的办法

00:00:20.429 --> 00:00:24.480
是创建一个按照你期望方式分类的列

00:00:24.480 --> 00:00:28.214
接下来 创建另外一个列 进行组的计数

00:00:28.214 --> 00:00:35.162
在此 我们使用 CASE 将订单分为 总销售额超过 500、

00:00:35.162 --> 00:00:38.959
和 500 及以下的分组

00:00:38.960 --> 00:00:41.225
对此查询 最好在 GROUP BY 子句中

00:00:41.225 --> 00:00:44.210
用数字替代整列计算

00:00:44.210 --> 00:00:45.890
因为在 GROUP BY 中重复 CASE 语句

00:00:45.890 --> 00:00:48.935
会让查询变得冗长

00:00:48.935 --> 00:00:50.330
现在 你可能会想

00:00:50.329 --> 00:00:54.769
为什么我不用 WHERE 子句过滤掉那些我不想计数的行？

00:00:54.770 --> 00:00:56.475
你是可以那样做

00:00:56.475 --> 00:01:00.030
结果可能是这样

00:01:08.200 --> 00:01:14.996
不幸的是 WHERE 子句只允许你一次计算一个条件

00:01:14.996 --> 00:01:17.905
如果我们有大量的不同案例 内容会特别冗长

00:01:17.905 --> 00:01:20.000
我们可能需要为每个案例编写不同的查询

